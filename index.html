<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Colectivos - Formosa</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.2/dist/leaflet.css" integrity="sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14=" crossorigin="" />
    <link rel="stylesheet" href="css/micss.css"></link>
    <script src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js" integrity="sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg=" crossorigin=""></script>
</head>
<body>
    <header class="header">
        <div class='Icono_header'>Colectivos</div>
        <div class='elementos'>
          <button class='mi_boton' onclick='detectarMiPosicion();'>
            Mi ubicacion
          </button>
        </div>
       
    </header>
    <div id='map' class='mi_mapa'>

    </div>

    <script src="js/afsa-barrios.js"></script>
    <script>
         var latlngs=[];
        var map = L.map('map').setView([-26.175569, -58.179647], 13);
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        maxZoom: 19,
                        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
                    }).addTo(map);

        var point;
        
        // navigator.geolocation.getCurrentPosition((position) => {
        //     let lat = position.coords.latitude;
        //     let long = position.coords.longitude;

        //     var point = L.point(lat, long);
        //     console.log(point);
        // });
        
        var point = L.latLng(-26.1521408, -58.1435392);
        barrios.features.forEach(elemento => {
          
            latlngs=L.GeoJSON.coordsToLatLngs(elemento.geometry.coordinates[0]);
            
            var poligon=L.polygon(latlngs, {color: 'red'}).addTo(map);
            var myIcon = L.divIcon({className: 'my-div-icon',html:"<span class='milabel'>"+elemento.properties['NOMBRE']+"</span>"});

            L.marker(poligon.getBounds().getCenter(), {icon: myIcon}).addTo(map);

           if(poligon.getBounds().contains(point)){
            console.log('si');
            console.log(elemento.properties['NOMBRE']);
            console.log(poligon.getBounds());
            
           }
        });

        // console.log(barrios.features[0].geometry.coordinates[0]);

        // for (i=0;i<barrios.features[0].geometry.coordinates[0].length-1;i++){
        //         console.log(barrios.features[0].geometry.coordinates[0][i]);
        //         latlngs.push(barrios.features[0].geometry.coordinates[0][i]);
        // }

        
        // console.log(latlngs);

        // var latlngs=L.GeoJSON.coordsToLatLngs(barrios.features[0].geometry.coordinates[0]);

        // // // create a red polygon from an array of LatLng points
        // // var latlngs = [[37, -109.05],[41, -109.03],[41, -102.05],[37, -102.04]];

        //  var polygon = L.polygon(latlngs, {color: 'red'}).addTo(map);

        // // // zoom the map to the polygon
        //  map.fitBounds(polygon.getBounds());

        var miubicacion;
        function detectarMiPosicion(){
          navigator.geolocation.getCurrentPosition((position) => {

              let lat = position.coords.latitude;
              let long = position.coords.longitude;

               miubicacion = L.latLng(lat, long);
               barrios.features.forEach(elemento => {
          
                  latlngs=L.GeoJSON.coordsToLatLngs(elemento.geometry.coordinates[0]);
                  
                  var poligon=L.polygon(latlngs, {color: 'red'})

                  if(poligon.getBounds().contains(point)){
                    console.log('si');
                    console.log(elemento.properties['NOMBRE']);
                    console.log(poligon.getBounds());
                    alert(elemento.properties['NOMBRE']);
                  }
              });
          });

        }
    </script>
</body>
</html>